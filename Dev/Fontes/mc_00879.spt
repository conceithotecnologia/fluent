/**
   Folha - Validação do cadastro de agregados (Assistência Médica)

   @author  Gabriel Montes
   @date    25/09/2015 15:15:00
   @trigger F20 B IUD

   Histórico
   ---------------------------------------------------------------------------------------------------------------------
   Legenda: [-] - Correção / [*] - Recurso modificado/melhorado / [+] - Implementação de recurso
*/
Create or Replace Function mc_00879####???() Returns trigger As $$
Declare
-- {Variáveis de uso interno}

   cOrigem1       [(fa4)].fa2_origem%type;        -- Prefixo da tabela de origem
   cOrigem2       [(fa4)].fa2_origem%type;        -- Prefixo da tabela de origem
   iRecno01       [(fa2)].fa2_recno%type;         -- Registro na tabela de origem
   iCaixa         [(fa2)].fa1_caixa%type;         -- Código do caixa
   dCaixa         [(fa2)].fa2_data%type;          -- Data da operação
   iDesdobra      [(fa2)].fa2_desdobra%type;      -- Detalhamento por natureza financeira?
   dConcilia      [(fa1)].fa1_data_ok%type;       -- Data de conciliação

   iAlterou       Integer;                        -- Indicador de alteração no registro
   cConcilia      VarChar(10);

Begin

   if tg_op <> 'DELETE' then
      perform sys_cpf(new.f20_cpf);
      
      if new.f20_nasceu > sys_getdatabase####???() then
         raise '[[Data de nascimento não pode ser posterior a data corrente.]]';
      end if;
      return new;
   else   
      return old;
   end if;

End;
$$ language plpgsql;