/**
   Recupera paramêtro

	@author    Ricardo Gonçalves
	@date      26/03/2012 17:23:54
	@trigger

	@param in_param_name nome da coluna onde o parâmetro deve ser obtido.
	@param in_default valor padrão caso o parâmetro não seja localizado.

	@return conteúdo do parâmetro informado.

	Histórico
	---------------------------------------------------------------------------------------------------------------------
   Legenda: [-] - Correção / [*] - Recurso modificado/melhorado / [+] - Implementação de recurso
*/
CREATE OR REPLACE FUNCTION sys_param_int####???(
   in in_param_name varchar,
   in in_default integer)
  RETURNS integer AS
$$
Declare
   ret   text;
   res   integer;
BEGIN
   res := in_default;
   -- Checa o tipo da coluna
   if not exists(
      select 1
        from ss012 a
             join ss085 b
               on b.recno = a.content_type
              and b.datatype in ('I', 'S', 'L') 
       where a.codtable in ('SS081', 'FCC', 'SS063')
         and a.columnname = upper(in_param_name))
   then
      raise 'O parâmetro "%" não é tipo integer.', upper(in_param_name);
   end if;

   ret := sys_param####???(in_param_name, '');

   if ret <> '' then
      res := ret::integer;
   end if;

   return res;
END;
$$
  LANGUAGE 'plpgsql' VOLATILE;