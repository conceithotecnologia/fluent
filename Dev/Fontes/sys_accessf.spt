/**
   Checa se o usuário tem acesso a um determinado recurso

	@author    Ricardo Gonçalves
	@date      19/03/2011 17:14:57
	@trigger

   @param   in_perm_id  Permissão a ser checada
   @param   in_msg   Mensagem de erro caso a permissão não seja concedida

	Histórico
	---------------------------------------------------------------------------------------------------------------------
*/
Create or Replace Function sys_accessf####???(
   in in_perm_id varchar(25),
   in in_msg text)
Returns void
As
$$
Declare
   tmsg   text;
Begin
   if sys_access####???(in_perm_id) <> 1 then
      tmsg := trim(in_msg);

      if substring(tmsg, length(tmsg), 1) <> '.' then
         tmsg := tmsg || '.';
      end if;

      raise '[[OPERAÇÃO NEGADA! % Permissão "%".]]', in_msg, in_perm_id;
   end if;
End;
$$
language plpgsql;