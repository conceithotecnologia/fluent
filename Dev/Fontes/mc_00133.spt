/**
   Bloqueia áreas selecionadas

	@author    Ricardo Gonçalves
	@date      14/07/2014 19:48:01
	@trigger   

	Histórico
	---------------------------------------------------------------------------------------------------------------------
   Legenda: [-] - Correção / [*] - Recurso modificado/melhorado / [+] - Implementação de recurso
*/
Create or Replace Function mc_00133####???(
   in in_motivo varchar)
Returns integer As
$$
BEGIN
   if coalesce(trim(in_motivo), '') = '' then
      raise '[[Para bloquear áreas de armazenamento é necessário informar o motivo.]]';
   end if;
   
   update [(a4a)] a
      set a4a_bloq = 1, a4a_bloqtxt = in_motivo
     from [(ss029)] s29
    where s29.session = sys_session()
      and s29.codform = 'A4A_ENDER_AREAS'
      and s29.codtable = 'A4A'
      and s29.recfile = a.recno
      and a.a4a_bloq = 0;
   
   Return 1;   
END
$$
language 'plpgsql';