/**
   Retorna o código do gerador de números de série para um determinado produto

	@author     Ricardo Gonçalves
	@date       28/07/2014
	@trigger    
   
   @param in_mat código do material que será utilizado na checagem do controle de número de série.
   
   @return integer código do gerador dos números de série ou 0 caso o material não tenha controle de número de série

	Histórico
	---------------------------------------------------------------------------------------------------------------------
*/
Create or Replace Function mc_00135####???(
   in in_mat varchar(25))
Returns integer As
$$
Declare 
   igerador    [(sbf)].a43_recno%type;
   isbf_numser [(sbf)].sbf_numser%type;   
BEGIN   
   select a43_recno, sbf_numser
     into igerador, isbf_numser
     from [(sbf)]
    where b1_codpro = in_mat;
    
   if not Found then
      raise '[[Informação complementar para o material % não cadastrada.]]', in_mat;
   end if;
   
   if isbf_numser != 1 then
      raise '[[Controle de número de série para o material % não está habilitado.]]', in_mat;
   end if;
    
   igerador := coalesce(igerador, 0);

   return igerador;
END
$$
language 'plpgsql';