/**
   Before - tabela FBA

	@author    Gabriel Montes
	@date      27/04/2015 16:19:00
	@trigger

	Histórico
	---------------------------------------------------------------------------------------------------------------------
   Legenda: [-] - Correção / [*] - Recurso modificado/melhorado / [+] - Implementação de recurso
*/
Create or Replace Function mc_00112####???() Returns trigger AS $$
Declare
   nTotNat numeric(18,4);
Begin
   
   If tg_op = 'DELETE' Then
      raise '[[Não é possível excluir, insira a "Data do fim da cobrança".]]';
   End If;
   
   If tg_op <> 'DELETE' Then
      if new.fba_dtfimcob is not null and new.fba_dtinicio > new.fba_dtfimcob then
         raise '[[Data do fim da cobrança não pode ser anterior a data de início.]]';
      end if;
      
   elsif tg_op = 'UPDATE' then
      if old.a1_codcli <> new.a1_codcli then
         raise '[[O código do Cliente não pode ser alterado, cadastre uma nova cobrança.]]';
      end if;   
      
   End If;
   
   Return new;

End;
$$ language plpgsql;