/**
   Processamento entrada DF-e

	@author    Ricardo Gonçalves
	@date      27/03/2019
	@trigger   A0T B IUD

	Histórico
	---------------------------------------------------------------------------------------------------------------------
   Legenda: [-] - Correção / [*] - Recurso modificado/melhorado / [+] - Implementação de recurso

*/
Create or Replace Function mc_01221####???()
Returns trigger AS $$
Begin
   if tg_op = 'DELETE' then
      return old;
   end if;   

   new.a0t_versao := uuid_generate_v4();

   if tg_op = 'UPDATE' then
      if new.a0t_cnpjcpf <> old.a0t_cnpjcpf then
         raise '[[O certificado só poder ser substituído por outro de mesma titularidade.]]';
      end if;
   end if;

   Return new;
End;
$$ language plpgsql;