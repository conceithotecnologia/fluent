/*==================================================================================================================================
  Rotina...: <l> mc_00525 </l>
  --------------------------------------------------------------------------------------------------------------------------------
  Descriусo: <d> Atualiza tabela espelho das Contas Bancрrias FAK a partir da manutenусo em SAK </d>
  --------------------------------------------------------------------------------------------------------------------------------
  Tipo.....: <t> Stored Procedure </t>
  --------------------------------------------------------------------------------------------------------------------------------
  Empresa..: MultCont Informрtica
  --------------------------------------------------------------------------------------------------------------------------------
  Autor....: Jurandy da Silva Costa
  --------------------------------------------------------------------------------------------------------------------------------
  Data.....: 28/08/2004 16:30:00
  --------------------------------------------------------------------------------------------------------------------------------
  Parametros
   [Entrada]ииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииии
   [Saida ]иииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииии
==================================================================================================================================*/
Create or Replace Function mc_00525####???() Returns trigger
AS $$
Declare

   nRecno    [(sak)].recno%type;           -- NЩmero do registro
   cConta    [(sak)].ak_cc%type;           -- NЩmero da conta bancрria

Begin
   If tg_op <> 'DELETE' Then
      cConta := new.ak_cc;
   Else
      cConta := old.ak_cc;
   End If;

   Select recno Into nRecno
     From [(fak)]
    Where ak_cc      = cConta
      And fak_filial = ???;

   If tg_op = 'INSERT' Or nRecno Is Null Then
      Insert Into [(fak)] ( ak_cc,     fak_filial, a9_codbanco,     a0_codag,     fak_fluxo,    fak_ativo )
           Values         ( new.ak_cc, ???,        new.a9_codbanco, new.a0_codag, new.ak_fluxo, new.sak_ativo );
   ElsIf tg_op = 'UPDATE' Then
      Update [(fak)]
         Set a9_codbanco = new.a9_codbanco, a0_codag = new.a0_codag, fak_fluxo = new.ak_fluxo, fak_ativo = new.sak_ativo
       Where recno = nRecno;
   Else
      Delete From [(fak)] Where recno = nRecno;
      Return old;
   End If;

   Return new;
End;
$$ language plpgsql;