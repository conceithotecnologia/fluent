/**
   Elimando tarefas processadas com êxito. Retenção de 1 hora

   @author  Ricardo Gonçalves
	@date    17/10/2019   

   @param   in_service  código do serviço
   @return  número de tarefas eliminadas

	Histórico
   ---------------------------------------------------------------------------------------------------------------------
   Legenda: [-] - Correção / [*] - Recurso modificado/melhorado / [+] - Implementação de recurso
*/
create or replace function sys_00047####???(
   in in_service integer)
returns integer as
$$
declare   
   rows        integer;
begin
   rows := 0;

   delete 
     from [(ss084)]
    where servico = in_service
      and estado = 2
      and processado < clock_timestamp() - interval '1hour';

   get diagnostics rows = ROW_COUNT;
   
   return rows;
end;
$$
language plpgsql;