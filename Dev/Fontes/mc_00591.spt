/*==================================================================================================================================
  Rotina...: <l> mc_00591 </l>
  --------------------------------------------------------------------------------------------------------------------------------
  Descriусo: <d> Atualiza o saldo mensal Realizado por natureza financeira em SFC </d>
  --------------------------------------------------------------------------------------------------------------------------------
  Tipo.....: <t> Stored Procedure </t>
  --------------------------------------------------------------------------------------------------------------------------------
  Empresa..: MultCont Informрtica
  --------------------------------------------------------------------------------------------------------------------------------
  Autor....: Jurandy da Silva Costa
  --------------------------------------------------------------------------------------------------------------------------------
  Data.....: 14/01/2005 18:30:00
  --------------------------------------------------------------------------------------------------------------------------------
  Parametros
   [Entrada]ииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииии
   [Saida ]иииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииии
==================================================================================================================================*/
Create or Replace Function mc_00591####???
() Returns trigger
As $$
Declare
Begin
   -- Se Exclusсo ou Alteraусo subtrai do acumulado o valor anterior
   If tg_op <> 'INSERT' Then
      Perform mc_00586####???( old.f1_codnat,  old.fa5_data, 0, (old.fa7_valor * -1),
                               old.fa8_filial, 'FA7', old.fa5_tipo, 0 );
   End If;
   -- Se nсo for Exclusсo soma no acumulado o valor atual
   If tg_op <> 'DELETE' Then

      Perform mc_00586####???( new.f1_codnat,  new.fa5_data, 0, new.fa7_valor,
                               new.fa8_filial, 'FA7', new.fa5_tipo, 0 );
   End If;
   If tg_op <> 'DELETE' Then
      Return new;
   Else
      Return old;
   End If;
End;
$$ language plpgsql;

