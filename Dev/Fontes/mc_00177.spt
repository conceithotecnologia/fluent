/*=========================================================================
| Rotina...: mc_00177                                                     |
| Descrição: Tabela de Prepostos                                          |     
| Tipo.....: Trigger Before LOF                                           |
| Empresa..: MultCont Informática                                         | 
| Autor....: Fabio Carvalho                                               |
| Data.....: 24/07/2009                                                   |
==========================================================================*/
Create or Replace Function mc_00177####???
() Returns trigger
As $$
Declare
-- {Variáveis de uso interno}

Begin
   if tg_op <> 'DELETE' then
       -- Validação da CNH
       if coalesce(new.lof_cnh, '') <> '' then 
          perform sys_cnh(new.lof_cnh);
          new.lof_aut_estrang:= null;
       else
          if coalesce(new.lof_aut_estrang, '') = '' then
             raise '[[É obrigatório o preenchimento da CNH ou Autorização do Estrangeiro !]]';
          end if;
          new.lof_cnh:= null;
       end if;  

       Return New;
   else
       Return Old;
   end if;
End;
$$ language plpgsql;