/**
   Trigger - Before NG5 - manifestação do Destinatario

	@author    Fabio Carvalho
	@date      23/01/2019
	@trigger   NG5 B IUD

	Histórico
	---------------------------------------------------------------------------------------------------------------------
   Legenda: [-] - Correção / [*] - Recurso modificado/melhorado / [+] - Implementação de recurso

*/
Create or Replace Function mc_01198####???() 
Returns trigger AS $$
Declare
Begin

   if tg_op = 'DELETE' then
      raise '[[ATENÇÃO. Não é possivel apagar registros desta tabela. Verifique!]]';
   end if;

   if tg_op = 'UPDATE' then
      -- 0-Sem Movimentacao 1-Confirmada 2-Desconhecida 3-Não realizada 4-Ciencia
      if old.ng5_csitconf = 1 and new.ng5_csitconf <> 1 then
         raise '[[ATENÇÃO. Alteração Não possivel. A Nota Já foi CONFIRMADA. Verifique!]]';
      elsif old.ng5_csitconf = 2 and new.ng5_csitconf <> 2 then
         raise '[[ATENÇÃO. Alteração Não possivel. A operação foi determinada como DESCONHECIDA. Verifique!]]';
      elsif old.ng5_csitconf = 3 and new.ng5_csitconf <> 3 then
         raise '[[ATENÇÃO. Alteração Não possivel. A operação foi determinada como NÃO REALIZADA. Verifique!]]';
      elsif old.ng5_csitconf = 4 and new.ng5_csitconf  in (0,2,3) then
         raise '[[ATENÇÃO. Alteração Não possivel. Já foi dado a CIÊNCIA da operação. Verifique!]]';
      end if;
   end if;
   Return new;

End;
$$ language plpgsql;